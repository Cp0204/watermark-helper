<!DOCTYPE html><html lang=zh><head><meta charset=UTF-8><title>水印助手</title><meta content="width=device-width,initial-scale=1" name=viewport><style>body{margin:auto;max-width:60vh}img{border:0;border-radius:5px;width:100%;box-sizing:border-box}canvas{display:none}label{display:flex;align-items:center;margin-top:8px}#drop-area{border:2px dashed #ccc;padding:10px;text-align:center}#upload-input{display:none}</style></head><body><canvas></canvas><a download id=imglink><img></a><div><div id=drop-area><input id=upload-input type=file accept=image/*> 拖放或点击选择图片</div><label>水印文字： <input id=content type=text value=仅供XX实名认证使用></label><label>水印颜色： <input id=color type=color value=#666666></label><label>图片宽度： <input id=width type=number value=2048></label><label>图片质量： <input id=quality type=range value=80 max=100 min=1><span id=imgsize></span></label><label>不透明度： <input id=alpha type=range value=20 max=100 min=10></label><label>文字大小： <input id=size type=range value=4 max=10 min=1></label><label>旋转角度： <input id=angle type=range value=-45 max=180 min=-180></label><label>水印行距： <input id=gap type=range value=150 max=300 min=20></label><label>水印字体： <input id=font type=text value=sans-serif></label><label><a download id=savelink href="javascript:alert('请先打开图片')">保存图片</a></label></div><script>let $=e=>document.querySelector(e),canvas=$("canvas"),ctx=canvas.getContext("2d"),imgEl=$("img"),imgLink=$("#imglink"),saveLink=$("#savelink"),imgSize=$("#imgsize"),img=null,updateImage=e=>{var a=URL.createObjectURL(e);imgSize.innerHTML=`(${Math.ceil(e.size/1024)} KB)`,imgEl.src=a,imgLink.href=a,saveLink.href=a},drawWatermark=()=>{if(img){var e=+$("#width").value,a=img.height*e/img.width,r=(canvas.width=e,canvas.height=a,ctx.drawImage(img,0,0,e,a),ctx.fillStyle=$("#color").value,ctx.globalAlpha=$("#alpha").value/100,Math.max(a,e)),l=$("#size").value*r/100,i=l*$("#gap").value/100,a=$("#angle").value*Math.PI/180,n=$("#content").value;if(ctx.font=`${l}px "${$("#font").value}"`,ctx.textBaseline="middle",ctx.rotate(a),n.length){var d=Math.sqrt(2*r*r),o=ctx.measureText(n).width;for(let a=-r,t=!1;a<=d;a+=l+i,t=!t)for(let e=-r-(t?o/2:0);e<=d+(t?o/2:0);e+=o+l)ctx.fillText(n,e,a)}canvas.toBlob(updateImage,"image/jpeg",$("#quality").value/100)}},handleImageUpload=e=>{var a=new FileReader,a=(a.onload=e=>{(img=new Image).onload=()=>{drawWatermark()},img.src=e.target.result},a.readAsDataURL(e),e.name.split(".")),e=(a.splice(-1,0,"watermarked"),a.join("."));imgLink.download=e,saveLink.download=e},dropArea=(document.addEventListener("change",e=>{"file"===e.target.type&&e.target.files.length?handleImageUpload(e.target.files[0]):drawWatermark()}),$("#drop-area"));dropArea.addEventListener("dragover",e=>{e.preventDefault(),dropArea.style.backgroundColor="#f2f2f2"}),dropArea.addEventListener("dragleave",e=>{e.preventDefault(),dropArea.style.backgroundColor=""}),dropArea.addEventListener("drop",e=>{e.preventDefault(),dropArea.style.backgroundColor="",handleImageUpload(e.dataTransfer.files[0])}),dropArea.addEventListener("click",()=>$("#upload-input").click())</script></body></html>